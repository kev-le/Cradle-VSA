(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{452:function(e,t,n){e.exports=n(745)},735:function(e,t,n){},744:function(e,t,n){},745:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),o=n(27),i=n(63),r=n(52),c=n(31),s=n(400),u=n(65),d=n(33),m={count:0,isIncrementing:!1,isDecrementing:!1},p=n(127),h=n.n(p);console.log("process.env.NODE_ENV","production");var g="http://cmpt373.csil.sfu.ca:8088/api",E=function(){return function(e){return e({type:"posts/UPDATE_POSTS_REQUESTED"}),h.a.get(g+"/hello-world").then(function(t){e({type:"posts/UPDATE_MSG",payload:t.data})})}},f={posts:[],isFetchingPosts:!1,msg:""},b={currentUser:{}},v=function(){return function(e){e({type:"posts/GET_PATIENTS_REQUESTED"}),h.a.get(g+"/patient/allinfo").then(function(t){console.log("get patients res: ",t),e({type:"posts/GET_PATIENTS",payload:t.data})}).catch(function(t){console.log(t),e({type:"posts/GET_POSTS_ERR"})})}},y={patientsList:[],isFetchingPatient:!1},O=Object(c.c)({counter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m;switch((arguments.length>1?arguments[1]:void 0).type){case"counter/INCREMENT_REQUESTED":return Object(d.a)({},e,{isIncrementing:!0});case"counter/INCREMENT":return Object(d.a)({},e,{count:e.count+1,isIncrementing:!e.isIncrementing});case"counter/DECREMENT_REQUESTED":return Object(d.a)({},e,{isDecrementing:!0});case"counter/DECREMENT":return Object(d.a)({},e,{count:e.count-1,isDecrementing:!e.isDecrementing});default:return e}},posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"posts/UPDATE_POSTS":return Object(d.a)({},e,{posts:t.payload,isLoading:!1});case"posts/UPDATE_POSTS_REQUESTED":return Object(d.a)({},e,{isLoading:!0});case"posts/UPDATE_POSTS_ERR":return Object(d.a)({},e,{isLoading:!1});case"posts/UPDATE_MSG":return Object(d.a)({},e,{msg:t.payload.msg});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_USER":return Object(d.a)({},e,{currentUser:t.payload});case"LOGOUT_USER":case"INVALID_USER":return Object(d.a)({},e,{currentUser:{}});default:return e}},patients:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"posts/GET_PATIENTS":return Object(d.a)({},e,{patientsList:t.payload,isLoading:!1});case"posts/GET_PATIENTS_REQUESTED":return Object(d.a)({},e,{isLoading:!0});case"posts/GET_POSTS_ERR":return Object(d.a)({},e,{isLoading:!1});default:return e}}}),P=u.a(),S=[s.a,Object(r.routerMiddleware)(P)],j=c.d.apply(void 0,[c.a.apply(void 0,S)].concat([])),C=Object(c.e)(Object(r.connectRouter)(P)(O),{},j),R=n(106),N=n(107),T=n(110),w=n(108),D=n(111),I=n(75),U=n(91),k=n(791),x=Object(i.connect)(function(e){return{currentUser:e.user.currentUser}})(function(e){return e.currentUser?l.a.createElement(U.Redirect,{to:"/patients"}):l.a.createElement(U.Redirect,{to:"/login"})}),M=n(237),_=n(105),L=n(401),A=n.n(L),F=function(e){return function(t){return fetch(g+"/user/register",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(n){n.message?console.log(n):t(G(e)).then(function(){t(Object(r.push)("/patients"))})})}},G=function(e){return function(t){return fetch(g+"/user/auth",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){e.message?console.log(e.message):(localStorage.setItem("token",e.token),t(H()).then(function(){t(Object(r.push)("/patients"))}))})}},H=function(){return function(e){var t=localStorage.token;return h.a.get(g+"/user/current",{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(t)}}).then(function(t){t.msg?(console.log(t),localStorage.removeItem("token"),e(Object(r.push)("/login"))):(console.log(t),e(J(t.data)))}).catch(function(t){return e(Object(r.push)("/login")),{message:"Not authorized"}})}},Q=function(){return function(e){localStorage.removeItem("token"),e(V()),e(Object(r.push)("/login"))}},V=function(){return{type:"LOGOUT_USER"}},J=function(e){return{type:"LOGIN_USER",payload:e}},B=n(759),q=n(785),z=n(789),W=n(792),Y=n(790),K=n(786),X=n(787),Z=n(788),$=[{key:"m",text:"Male",value:"M"},{key:"f",text:"Female",value:"F"},{key:"o",text:"Other",value:"I"}],ee=[{key:"y",text:"Yes",value:!0},{key:"n",text:"No",value:!1}],te=function(e){function t(){var e,n;Object(R.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(T.a)(this,(e=Object(w.a)(t)).call.apply(e,[this].concat(o)))).state={columns:[{title:"Patient ID",field:"patientId",defaultSort:"asc"},{title:"Patient Name",field:"patientName",render:function(e){return l.a.createElement("div",null,l.a.createElement("p",null,e.patientName),l.a.createElement("a",{onClick:function(){return n.openPatientModal({rowData:e})}},"View Info"))}},{title:"Readings",render:function(e){return l.a.createElement("a",{onClick:function(){return n.openReadingModal({rowData:e})}},"View Reading")}},{title:"Follow Up Status",field:"followUp",render:function(e){return e.isPregnant?l.a.createElement("button",null,"Follow Up"):l.a.createElement("p",null,"Not needed")}}],data:[],selectedPatient:{patientId:"",patientName:"Test",patientSex:"F",medicalHistory:"",drugHistory:"",villageNumber:"",readings:[]},displayPatientModal:!1,displayReadingModal:!1},n.componentDidMount=function(){console.log("componentDidMount"),n.props.getCurrentUser().then(function(e){void 0===e&&n.props.getPatients()})},n.handleSelectChange=function(e,t){console.log(t),n.setState({selectedPatient:Object(d.a)({},n.state.selectedPatient,Object(_.a)({},t.name,t.value))})},n.openPatientModal=function(e){console.log(e),console.log("open patient modal"),n.setState({displayPatientModal:!0,selectedPatient:e.rowData})},n.closePatientModal=function(){console.log("close patient modal"),n.setState({displayPatientModal:!1})},n.openReadingModal=function(e){console.log(e),console.log("open reading modal"),n.setState({displayReadingModal:!0,selectedPatient:e.rowData})},n.closeReadingModal=function(){console.log("close reading modal"),n.setState({displayReadingModal:!1})},n.handleSubmit=function(e){e.preventDefault();var t=n.state.selectedPatient;delete t.readings,delete t.tableData,delete t.patientId;var a=JSON.stringify({patient:t});console.log(a)},n}return Object(D.a)(t,e),Object(N.a)(t,[{key:"render",value:function(){var e=this;if(!this.props.user.isLoggedIn)return l.a.createElement("div",null);var t=[];if(this.state.selectedPatient.readings.length>0)for(var n=0;n<this.state.selectedPatient.readings.length;n++)t.push(l.a.createElement("p",null,"Reading ",n+1)),t.push(l.a.createElement("p",null,"Date Referred: ",this.state.selectedPatient.readings[n].dateReferred)),t.push(l.a.createElement("p",null,"BP Diastolic: ",this.state.selectedPatient.readings[n].bpDiastolic)),t.push(l.a.createElement("p",null,"BP Systolic: ",this.state.selectedPatient.readings[n].bpSystolic)),this.state.selectedPatient.readings[n].comment?(t.push(l.a.createElement("p",null,"Referral Status: Referred! : ",this.state.selectedPatient.readings[n].comment)),t.push(l.a.createElement(B.a,null,"Follow Up"))):t.push(l.a.createElement("p",null,"Referral Status: Not Referred!")),t.push(l.a.createElement(q.a,null));return l.a.createElement("div",null,l.a.createElement("h1",null,"Patients List"),l.a.createElement("p",null," only logged in users are allowed to see this "),l.a.createElement(A.a,{title:"Patients Table",columns:this.state.columns,data:this.props.data,editable:{onRowAdd:function(t){return new Promise(function(n){setTimeout(function(){n();var a=Object(M.a)(e.state.data);a.push(t),e.setState(Object(d.a)({},e.state,{data:a}))},600)})},onRowUpdate:function(t,n){return new Promise(function(a){setTimeout(function(){a();var l=Object(M.a)(e.state.data);l[l.indexOf(n)]=t,e.setState(Object(d.a)({},e.state,{data:l}))},600)})},onRowDelete:function(t){return new Promise(function(n){setTimeout(function(){n();var a=Object(M.a)(e.state.data);a.splice(a.indexOf(t),1),e.setState(Object(d.a)({},e.state,{data:a}))},600)})}}}),l.a.createElement(z.a,{closeIcon:!0,onClose:this.closePatientModal,open:this.state.displayPatientModal},l.a.createElement(z.a.Header,null,"Patient Readings"),l.a.createElement(z.a.Content,{scrolling:!0},l.a.createElement(z.a.Description,null,l.a.createElement(W.a,null,"Patient Readings for ID #",this.state.selectedPatient.patientId),l.a.createElement(q.a,null),l.a.createElement(Y.a,{onSubmit:this.handleSubmit},l.a.createElement(Y.a.Group,{widths:"equal"},l.a.createElement(Y.a.Field,{name:"patientName",value:this.state.selectedPatient.patientName,control:K.a,label:"Name",placeholder:"Patient Name",onChange:this.handleSelectChange}),l.a.createElement(Y.a.Field,{name:"patientAge",value:this.state.selectedPatient.patientAge,control:K.a,label:"Age",placeholder:"Patient age",onChange:this.handleSelectChange}),l.a.createElement(Y.a.Field,{name:"patientSex",control:X.a,value:this.state.selectedPatient.patientSex,label:"Gender",options:$,placeholder:"Gender",onChange:this.handleSelectChange})),l.a.createElement(Y.a.Group,{widths:"equal"},l.a.createElement(Y.a.Field,{name:"villageNumber",value:this.state.selectedPatient.villageNumber,control:K.a,label:"Village Number",placeholder:"Village Number",onChange:this.handleSelectChange}),l.a.createElement(Y.a.Field,{name:"isPregnant",value:this.state.selectedPatient.isPregnant,control:X.a,label:"Pregant",options:ee,onChange:this.handleSelectChange})),l.a.createElement(Y.a.Field,{name:"drugHistory",value:this.state.selectedPatient.drugHistory||"",control:Z.a,label:"Drug History",placeholder:"Patient's drug history...",onChange:this.handleSelectChange}),l.a.createElement(Y.a.Field,{name:"medicalHistory",value:this.state.selectedPatient.medicalHistory||"",control:Z.a,label:"Medical History",placeholder:"Patient's medical history...",onChange:this.handleSelectChange}),l.a.createElement(Y.a.Field,{control:B.a},"Submit"))))),l.a.createElement(z.a,{closeIcon:!0,onClose:this.closeReadingModal,open:this.state.displayReadingModal},l.a.createElement(z.a.Header,null,"Patient Information"),l.a.createElement(z.a.Content,{scrolling:!0},l.a.createElement(z.a.Description,null,l.a.createElement(W.a,null,"Patient ID #",this.state.selectedPatient.patientId),l.a.createElement(q.a,null),l.a.createElement("p",null,t)))))}}]),t}(a.Component),ne=Object(i.connect)(function(e){var t=e.patients,n=e.user;return{patients:t,data:t.patientsList,user:n.currentUser}},function(e){return Object(c.b)({getPatients:v,getCurrentUser:H,getPosts:E},e)})(te),ae=function(e){function t(){var e,n;Object(R.a)(this,t);for(var a=arguments.length,l=new Array(a),o=0;o<a;o++)l[o]=arguments[o];return(n=Object(T.a)(this,(e=Object(w.a)(t)).call.apply(e,[this].concat(l)))).state={email:"",password:""},n.handleChange=function(e){n.setState(Object(_.a)({},e.target.name,e.target.value))},n.handleSubmit=function(e){e.preventDefault(),console.log("submitted!"),n.props.userPostFetch(n.state)},n}return Object(D.a)(t,e),Object(N.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:"loginWrapper"},l.a.createElement("form",{onSubmit:this.handleSubmit,className:"content-box"},l.a.createElement("h1",null,"Sign Up"),l.a.createElement("label",null,"Email"),l.a.createElement("input",{name:"email",type:"email",value:this.state.email,onChange:this.handleChange}),l.a.createElement("br",null),l.a.createElement("label",null,"Password"),l.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleChange}),l.a.createElement("br",null),l.a.createElement("div",{className:"flexbox"},l.a.createElement("input",{className:"contant-submit white",type:"submit"}),l.a.createElement(I.a,{className:"link",style:{textDecoration:"none"},to:"/login"}," Login "))))}}]),t}(a.Component),le=Object(i.connect)(null,function(e){return Object(c.b)({userPostFetch:F},e)})(ae),oe=(n(735),function(e){function t(){var e,n;Object(R.a)(this,t);for(var a=arguments.length,l=new Array(a),o=0;o<a;o++)l[o]=arguments[o];return(n=Object(T.a)(this,(e=Object(w.a)(t)).call.apply(e,[this].concat(l)))).state={email:"",password:""},n.handleChange=function(e){n.setState(Object(_.a)({},e.target.name,e.target.value))},n.handleSubmit=function(e){e.preventDefault(),n.props.userLoginFetch(n.state)},n}return Object(D.a)(t,e),Object(N.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:"loginWrapper"},l.a.createElement("form",{onSubmit:this.handleSubmit,className:"content-box"},l.a.createElement("h1",null,"Login"),l.a.createElement("label",null,"Email"),l.a.createElement("input",{name:"email",type:"email",value:this.state.email,onChange:this.handleChange}),l.a.createElement("br",null),l.a.createElement("label",null,"Password"),l.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleChange}),l.a.createElement("br",null),l.a.createElement("div",{className:"flexbox"},l.a.createElement("input",{className:"contant-submit white",type:"submit"}),l.a.createElement(I.a,{className:"link",style:{textDecoration:"none"},to:"/signup"}," Sign up "))))}}]),t}(a.Component)),ie=Object(i.connect)(function(e){return{email:e.user.currentUser.email}},function(e){return Object(c.b)({userLoginFetch:G},e)})(oe),re=function(e){function t(){var e,n;Object(R.a)(this,t);for(var a=arguments.length,l=new Array(a),o=0;o<a;o++)l[o]=arguments[o];return(n=Object(T.a)(this,(e=Object(w.a)(t)).call.apply(e,[this].concat(l)))).state={activeItem:"Home"},n.handleItemClick=function(e,t){var a=t.name;return n.setState({activeItem:a})},n}return Object(D.a)(t,e),Object(N.a)(t,[{key:"render",value:function(){var e=this,t=(this.props.color,this.state.activeItem);return l.a.createElement("div",null,l.a.createElement(k.a,{color:"blue",key:"blue",inverted:!0},l.a.createElement(k.a.Item,{name:"Home",active:"Home"===t,onClick:this.handleItemClick},l.a.createElement(I.a,{className:"link",style:{textDecoration:"none"},to:"/"}," Home ")),l.a.createElement(k.a.Item,{name:"Patient",active:"Patient"===t,onClick:this.handleItemClick},l.a.createElement(I.a,{className:"link",style:{textDecoration:"none"},to:"/patients"}," Patients ")),l.a.createElement(k.a.Item,{name:"Login",active:"Login"===t,onClick:this.handleItemClick},this.props.user.isLoggedIn?l.a.createElement(I.a,{className:"link",style:{textDecoration:"none"},to:"/",onClick:function(){return e.props.logoutUser()}},"Logout"):l.a.createElement(I.a,{className:"link",style:{textDecoration:"none"},to:"/login"}," Login ")),this.props.user.isLoggedIn?l.a.createElement("div",null):l.a.createElement(k.a.Item,{name:"Signup",active:"Signup"===t,onClick:this.handleItemClick},l.a.createElement(I.a,{className:"link",style:{textDecoration:"none"},to:"/signup"}," Signup "))),l.a.createElement("main",null,l.a.createElement(U.Route,{exact:!0,path:"/",component:x}),l.a.createElement(U.Route,{exact:!0,path:"/patients",component:ne}),l.a.createElement(U.Route,{exact:!0,path:"/signup",component:le}),l.a.createElement(U.Route,{exact:!0,path:"/login",component:ie})))}}]),t}(a.Component),ce=Object(i.connect)(function(e){return{user:e.user.currentUser}},function(e){return Object(c.b)({logoutUser:Q},e)})(re);n(743),n(744);console.log("API BASE_URL: "+g);var se=document.querySelector("#root");Object(o.render)(l.a.createElement(i.Provider,{store:C},l.a.createElement(r.ConnectedRouter,{history:P},l.a.createElement("div",null,l.a.createElement(ce,null)))),se)}},[[452,1,2]]]);
//# sourceMappingURL=main.5dddaac2.chunk.js.map